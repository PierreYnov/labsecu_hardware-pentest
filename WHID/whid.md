# USB

## Cas généraux
https://esdacademy.blogspot.com/2020/10/les-stations-blanches-un-sas-pour.html?m=1

https://lh5.googleusercontent.com/TuqtjTyQTnIXopkHs4WjBBB_56LLX3mB0FHUs7Gm_RrhKYX3NsH2xoi0xVDbnZFZS26TSTC6in9wi_kLyOYKbFpFLLbVtgRK0CmDFR0Wum3T9LPlTxyqvOhmJdLRl3UzC0L3xej5

intrusion physique http://honeywellprocess.blob.core.windows.net/public/Marketing/White-Paper-USB-Security-Myths-vs-Reality.pdf

"Threat actors that are targeting your organization will perform [open source intelligence] or reconnaissance on individuals that may be vulnerable because of financial pressures, disgruntlement, social engineering, or other reasons," Rickard says. "For example, if an employee posted information about being in financial debt or being upset about their employer on social media, a threat actor may then take advantage of these statements. At this point, they may begin to build a relationship with this individual."  

The good news is, not all employees will fall for it. For example, an employee at Tesla rejected a $1 million bribe to install malware for an attacker, said Fowler, who recently joined Darktrace after a career in the CIA. He faults the attackers for not doing their homework.

"Before they even offered the money, they should have gotten to a place to know that this is a type of person that would take the money," he said. "And it shouldn't have been a question. If you're bringing along a [human] asset, by the time you kind of do the 'reveal,' you should already know, 'You're joining us. We all know what's happening here.'"

Malicious actors will research an organization to identify employees by using tools such as LinkedIn, ZoomInfo, Maltego with Social Links, and Jigsaw, according to Daniel Wood, associate vice president of consulting at Bishop Fox. More advanced attackers will even use pay services such as Pipl API, LexusNexis Westlaw, and TransUnion TLOxp.

"Once they have a target list, they will usually refine the list by researching individual employees, paying close attention to current role, skills, and technical knowledge, as well as more personal attributes, such as location, arrest records, family, social media presence, and other publicly available data people tend to expose," he says.

With their soft targets selected, attackers then have to devise a plan to compromise them "in order to carry out an attack with a specific purpose, whether it's obtaining confidential nonpublic information about an organization, or person or asking the compromised employee to provide working credentials to a service, or a myriad of other things," Wood add

To protect critical infrastructure against such threats, use a multilayered approach.

   
    Garantissez d’abord la sécurité physique pour que le personnel non autorisé ne puisse pas connecter n’importe quel dispositif USB aux systèmes de contrôles industriels. Bloquez physiquement les ports USB que ces systèmes n’utilisent pas, et empêcher le retrait des HID déjà connectés.
    Formez vos employés pour qu’ils connaissent les différents genres de menaces, y compris les dispositifs USB infectés, et ainsi éviter certains incidents comme celui de La La Land.
    Segmentez correctement le réseau, et gérez les droits d’accès pour empêcher les pirates informatiques d’atteindre les systèmes utilisés pour contrôler les infrastructures critiques.
    Protégez tous les systèmes de l’entreprise en installant des solutions de sécurité qui peuvent détecter toutes les menaces. La technologie de Kaspersky Endpoint Security ne va pas autoriser les HID à se connecter, sauf si l’utilisateur saisit un code en utilisant un HID déjà autorisé à réaliser cette action.




Think about the effort expended on telling children not to take candy from strangers. It’s the same idea with encouraging employees not to put found USB devices into their computers. One 2016 study dropped 297 USBs on a university campus. Of the 98% of found devices that were picked up, 45% were plugged into computers.

La troisième génération des outils USB qui permettent de réaliser des tests d’intrusion a atteint un tout autre niveau. L’outil WHID Injector est l’un d’entre eux, et il s’agit tout simplement de Rubberducky avec une connexion Wi-Fi. Comme il est connecté en Wi-Fi, il n’y a pas besoin de programmer en amont toutes les actions qu’il est censé effectuer. Un pirate informatique peut contrôler l’outil à distance, ce qui apporte une certaine flexibilité, et lui permet de travailler avec différents systèmes d’exploitation

conf : https://youtu.be/ZI5fvU5QKwQ

Article ultra interessant et utile https://elie.net/static/images/images/what-are-malicious-usb-keys-and-how-to-create-a-realistic-one/USB_HID_spoofing_attack_illustrated.960.png


https://elie.net/blog/security/what-are-malicious-usb-keys-and-how-to-create-a-realistic-one/

cas concret 
https://raw.githubusercontent.com/certsocietegenerale/Publications/master/DFRWS%20EU19%20-%20The%20Rise%20Of%20HID%20Devices.pdf


Ensuite, les attaquants ont besoin d’un moyen pour que leur clé USB ou leur périphérique avec port USB soit branché sur l’appareil ciblé. Ils peuvent soit le faire eux-même, soit utiliser l’ingénierie sociale pour que quelqu’un d’autre le fasse, sans que cette personne ne s’en rende compte. Les clés USB peuvent être déposées dans la rue, au bureau, dans une boîte aux lettres ou données en cadeau lors d’événements, comme cela s’est peut-être produit lors du sommet du G20 de 2013. 

------------------------------------

atteindre des reseaux solo ou qui sont cache 

cible atteignable physiquement direct ou indirect

reverse shell puis mimikatz

pas lancer le payload tout seul, distraire avec des doc confidentiel ou du porno

https://youtu.be/9xBs0cG0hjY?t=1043 partie whid

scenario : qqun branche la clé et il suffit d'attendre et charge declencher depuis le tel

si pas de visu, jumelle telescope ou drone

a 24minute il parle de comment venir brancher


personne, pas ferme a clé ,on branche

une autre excuse pour rentrer https://youtu.be/9xBs0cG0hjY?t=1805

clé usb cadeau, d'une entreprise amie, autocllant par exemple

 trousseau de clé par terre avec le usb dedans



 ----------------

 acces a des endroit important sans passer par le reseau, donc difficile pour le forensic

la pensée secu physique est souvent oublié, alors que les acteurs nefaste peuvent venir par la facilement pour atteindre une orga
des fois des attaques trop sophistique pour au final pas realiste

pas besoin d'avoir de perm, c'est juste un clavier


https://youtu.be/HTrQHZtNyBw?t=1943 il cache son  texte powershell

ouvre un reverse et apres va en arriere plan faire le reste


souvent dans les boite c'est l'executif, le boss qui vont pas se faire chier sur la secu car il dev pas ou autre et ils auront sur leur pc des choses sympa meme si ils sont pas dans les dmz serv ou dev etc

en terme de blue team c'est leger encore sur la défense


## WHID




quand on branche la premiere fois on aura un quick setup

il y aura un nouveau réseau wifi

panel en 192.168.1.1

3mb de storage 

https://github.com/swisskyrepo/WHID_Toolkit

ESPloit uses its own scripting language and not Ducky Script,
although a Ducky Script to ESPloit converter is available at: https://exploitagency.github.io/Duckuino/index.html

to read af https://github.com/whid-injector/WHID/tree/master/ESPloitV2_whid

https://swisskyrepo.github.io/WhidInjector/



