# Titre : Comment hacké votre entreprise avec 11 euros ?




## introduction avec le cas de la femme de ménage qui branche un usb ou alos un fake stagiaire

## prise de controle a distance et exfiltration des données, ou mimikatz, persistence ou ransomware

https://elie.net/static/images/images/what-are-malicious-usb-keys-and-how-to-create-a-realistic-one/USB_HID_spoofing_attack_illustrated.960.png reverse shell image






## mais c'est quoi cet usb 

### jhid c quoi

Ce type d’attaque est nommé attaque HID (Human Interface Device) qui a pour but de faire passer l’outil pour un clavier, afin d’injecter une suite de combinaisons de touches spécifiques à des actions malveillantes.


HID = https://i.gyazo.com/9cb94a964c26f38f61a9292d73ecc62e.png

ça simule un clavier pour envoyer à la machine cible des séquences de touches (préparées dans des scripts) ; sauf que ! Les scripts peuvent être envoyés à la volée, à volonté, via WIFI.

la capacité de contrôler à distance le comportement de la clé USB malveillante.

Avec ce que nous propose Bongiorni, il est possible d’interagir avec l’appareil via WIFI et ainsi de maintenir l’attaque active.

Émulation d'un clavier

La troisième génération des outils USB qui permettent de réaliser des tests d’intrusion a atteint un tout autre niveau. L’outil WHID Injector est l’un d’entre eux, et il s’agit tout simplement de Rubberducky avec une connexion Wi-Fi. Comme il est connecté en Wi-Fi, il n’y a pas besoin de programmer en amont toutes les actions qu’il est censé effectuer. Un pirate informatique peut contrôler l’outil à distance, ce qui apporte une certaine flexibilité, et lui permet de travailler avec différents systèmes d’exploitation



### presentation technique

Une fois que celle-ci est branchée sur l’ordinateur de la victime, il est possible d’envoyer des charges utiles via l’interface ESPloit

multi platform, opensource, pid changeable, wifi et pas cher

192.168.1.1

3mb de storage 

ESPloit uses its own scripting language and not Ducky Script,
although a Ducky Script to ESPloit converter is available at: https://exploitagency.github.io/Duckuino/index.html

https://blog.sodifrance.fr/whid-ninja-the-wireless-rubber-ducky/

https://geek3om.blogspot.com/2020/03/WHIDInjectorNextLevelUSBattack.html

### explication en détail

on pet cacher le ssid
spoof hid pid ( voir quel clavier dans la boite et flasher le eme ) et changer langue sur arduino

Les hardware ont des string qui les identifie pour les os pour savoir quel drivers doit on charger pour les interpréter 

Usb ont la Vendor ID et la Product ID

### comment la cacher dans des objets

https://raw.githubusercontent.com/certsocietegenerale/Publications/master/DFRWS%20EU19%20-%20The%20Rise%20Of%20HID%20Devices.pdf

on peut cacher l'usb dans un hub usb, ou dans une souris qui change de couleur par exemple

il n'y a pas que les clé usb, on peut ataquer par un chargeur usb, un hub usb, un chargeur de CE, un ventilateur, bref tout ce qui a un cable usb

quand on voit une usb on peu etre suspicieux mais pas devant un ventilo usb, une souris ou une boule plasma
usb hub

https://medium.com/@LucaBongiorni/whid-injector-how-to-bring-hid-attacks-to-the-next-level-b06a40b7df22
https://blog.rootshell.be/2018/05/22/evil-mouse-project/

### comment s'en proteger


Les entreprises industrielles ont toujours besoin de clés USB pour plusieurs raisons : - Tous les sites/usines ne sont pas connectés - l'USB peut être le seul moyen d'obtenir des mises à jour de certains fournisseurs - Facilité d'utilisation. Les gens gravitent vers la voie de la moindre résistance, et du succès le plus rapide - L'interdiction des USB en tant que politique s'est avérée inefficace.

- Garantissez d’abord la sécurité physique pour que le personnel non autorisé ne puisse pas connecter n’importe quel dispositif USB aux systèmes de contrôles industriels. Bloquez physiquement les ports USB que ces systèmes n’utilisent pas, et empêcher le retrait des HID déjà connectés.

- Formez vos employés pour qu’ils connaissent les différents genres de menaces, y compris les dispositifs USB infectés, et ainsi éviter certains incidents comme celui de La La Land.
Segmentez correctement le réseau, et gérez les droits d’accès pour empêcher les pirates informatiques d’atteindre les systèmes utilisés pour contrôler les infrastructures critiques.

https://i.gyazo.com/9616bb95e68c6fbc418b6e07fb7641ca.png

https://gyazo.com/0699064237eba341af9c8c95c4ba30ae

https://gyazo.com/9f805940a30e07d8bba73ff42863571e

- usb condom

Comment contrer ? Sensibiliser 
Bloquer les port usb
Restrict les types d'usb utilisable sur la politique Windows mais c spoofable 

Pour Windows dans Regedit dans DeviceInstallRestrictions
Pour linux : udev rules 

Usbdeview logiciel qui permet d'avoir plein d'infos sur les usb


- clé usb cadeau, d'une entreprise amie, autocllant par exemple

- trousseau de clé par terre avec le usb dedans







# visu 

drone 

jumelle

telescope

à coté si couloir de plusieur boite